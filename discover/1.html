<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discover</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,system-ui}
body{background:#f6f7f4;overflow:hidden}

header{
  padding:14px 16px;
  font-size:18px;
  font-weight:600;
}

.feed{
  height:calc(100vh - 56px);
  overflow-y:auto;
  scroll-snap-type:y mandatory;
}

.story{
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  scroll-snap-align:start;
}

.card{
  width:92%;
  max-width:420px;
  height:75vh;
  border-radius:22px;
  overflow:hidden;
  position:relative;
  color:#fff;
}

.card img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.overlay{
  position:absolute;
  inset:0;
  background:linear-gradient(to top,rgba(0,0,0,.8),rgba(0,0,0,.15));
}

.content{
  position:absolute;
  bottom:0;
  padding:18px;
}

.content h2{font-size:20px;margin-bottom:8px}
.content p{font-size:14px;opacity:.9}
.source{margin-top:12px;font-size:13px;opacity:.8}

.loader{text-align:center;padding:40px;color:#64748b}
</style>
</head>

<body>

<header>Discover</header>
<div id="loader" class="loader">Loadingâ€¦</div>
<div id="feed" class="feed"></div>

<script>
const API_KEY = "937697397c9c481e23e8f45d1e0fcdf3";
const feed = document.getElementById("feed");
const loader = document.getElementById("loader");

const params = new URLSearchParams(location.search);
const keyword = params.get("key") || "technology";

(async ()=>{
  const res = await fetch(
    `https://gnews.io/api/v4/search?q=${keyword}&lang=en&max=10&apikey=${API_KEY}`
  );
  const data = await res.json();
  loader.style.display="none";

  localStorage.setItem("articles", JSON.stringify(data.articles));

  data.articles.forEach((a,i)=>{
    const s=document.createElement("div");
    s.className="story";
    s.innerHTML=`
      <div class="card" onclick="openArticle(${i})">
        <img src="${a.image}">
        <div class="overlay"></div>
        <div class="content">
          <h2>${a.title}</h2>
          <p>${a.description || ""}</p>
          <div class="source">${a.source.name}</div>
        </div>
      </div>`;
    feed.appendChild(s);
  });
})();

function openArticle(i){
  location.href = "2.html?article=" + i;
}
</script>

</body>
</html>
